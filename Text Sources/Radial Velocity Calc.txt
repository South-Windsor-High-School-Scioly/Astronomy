a detailed derivation of

The Radial Velocity Equation
Kelsey I. Clubb

ABSTRACT
Of the over 300 extrasolar planets discovered to date, the vast majority have been
found using the RADIAL VELOCITY METHOD (also known as DOPPLER SPECTROSCOPY
or the DOPPLER METHOD). The purpose of this paper is to derive the theoretical
equation that is associated with the variation over time of a star’s velocity along an
observer’s line‐of‐sight – a quantity that can be precisely measured with an optical
telescope – from first principles. In other words, we will begin with the seemingly simple
situation of a planet orbiting a star (often referred to as the “parent star” or, the term
that will be used throughout this paper, the “host star”) and then start applying basic
principles of physics and utilize mathematical tools in order to analyze and describe the
star‐planet system. The end result will be a complete and detailed derivation of the
RADIAL VELOCITY EQUATION.

PREFACE
“The most incomprehensible thing about the universe is that it is comprehensible”
– Albert Einstein

The discovery of extrasolar planets has profound implications not only for the scientists that find them,
but for the entire population of Earth. For this reason, I have attempted to make this derivation
accessible to the layperson; however, some knowledge of advanced mathematics, physics, and
astronomy is needed in order to completely follow every step.
I would like to thank my adviser, Debra Fischer, for suggesting this derivation as one of my first
introductions to extrasolar planet research. The entire process has helped me immensely to not only
understand the delicate intricacies of the radial velocity method, but also to be able to see the bigger
picture of how research makes use of all the physics, astronomy, and math I’ve learned. Thank you!
As much as I would like this derivation to be without error, nothing in life is perfect. With that said, if
you happen to come across an error, typo, or anything else that needs correction I’d be happy to be
notified. You can e‐mail me at kclubb@stars.sfsu.edu with any corrections, comments, or suggestions.

Kelsey I. Clubb
Department of Physics & Astronomy
San Francisco State University
San Francisco, CA USA
August 2008

2 THE RADIAL VELOCITY EQUATION

Table of Contents
The Orbits of a Planet and its Host Star ....................................................... 4
Analyzing The Star‐Planet System ............................................................... 6
The Center of Mass Frame of Reference...................................................... 7
The Laws of Isaac Newton........................................................................... 8
The Laws of Johannes Kepler .................................................................... 10
Angular Momentum ................................................................................. 14
The Equation of an Ellipse ......................................................................... 15
Properties of an Ellipse ............................................................................. 18
Definitions of Orbital Parameters.............................................................. 20
Radial Velocity .......................................................................................... 22
Radial Velocity Semi‐Amplitude ................................................................ 25
Appendix A: Proof that δ = 0..................................................................... 29
Appendix B: The Expression for z .............................................................. 33
Reference for Calculating RV Semi‐Amplitude ........................................... 34

THE RADIAL VELOCITY EQUATION 3

THE ORBITS OF A PLANET AND ITS HOST STAR
We begin our derivation with the simple situation of a planet orbiting its host star (shown in Figure 1).

(a)

NOT TO SCALE
(b)

NOT TO SCALE
Figure 1 – A planet orbiting its host star.
The dashed line represents the path of the planet’s orbit.
(a) Top view of the star‐planet system. (b) Side view of the star‐planet system.

In actuality, both the star and planet orbit their mutual center of mass (henceforth abbreviated CM),
but because the star is much more massive than the planet, the CM of the star‐planet system is much
closer to the star. In fact, the CM is only slightly displaced from the center of the star.
Now we need to set up a coordinate system (shown in Figure 2) and review some basics of vectors.
4 THE RADIAL VELOCITY EQUATION

CM

êr
distance between the star and planet

r
r1

r2
NOT TO SCALE

Figure 2 – The coordinate system we will utilize when analyzing the star‐planet system.
(Note that the location of the CM in this figure is exaggerated in order to more easily illustrate the vectors that depend on it)

Some Basics of Vectors
•

Vector quantities (or “VECTORS”) have both magnitude and direction, unlike scalar
quantities (or “SCALARS”) which have only magnitude

•

Vector quantities are usually denoted
by placing an arrow above the symbol

representing the vector (e.g. F ) and/or placing the symbol in boldface (e.g. F)

•

The MAGNITUDE OF A VECTOR is a scalar equal to the length of the vector (which is
always a positive number)
€

•

The magnitude
(or length) of a vector is usually denoted by placing bars around the

vector (e.g. F ) or just the symbol representing the vector in normal font (e.g. F)

•

A UNIT VECTOR is a vector whose magnitude is equal to 1

•

The€DIRECTION OF A VECTOR tells you which way the vector points

•

The direction of a vector is usually denoted by placing a hat above the symbol
representing the vector (e.g. Fˆ )

•

The NEGATIVE OF A VECTOR is another vector that has the same magnitude as the
original vector, but points in the opposite direction (e.g. if F is a vector
with a

€
magnitude equal to F and a direction pointing to the right, then −F is a vector with a
magnitude equal to F and a direction pointing to the left)
€
€

THE RADIAL VELOCITY EQUATION 5

ANALYZING THE STAR-PLANET SYSTEM
Using Figure 2 and what we know about vectors, we can define the following:

eˆr ≡ unit vector along the line connecting the star and planet that points to the right

r ≡ vector pointing from star to planet (right)

r1 ≡ vector pointing from CM to star (left)

r2 ≡ vector pointing from CM to planet (right)

€
€


r ≡ magnitude of r = distance between the star and planet

r1 ≡ magnitude of r1 = distance between the CM and star

r2 ≡ magnitude of r2 = distance between the CM and planet
€
€

rˆ ≡ direction
€
€ of r = +eˆr

rˆ1 ≡ direction
€
€ of r1 = − eˆr

rˆ2 ≡ direction of r2 = +eˆr
€
€ €
€ Using the definitions
€ € above and the fact that a vector has both a magnitude and a direction, we find:

€
€

€


r ≡ r rˆ = r (+ eˆr )

r1 ≡ r1 rˆ1 = r1 (− eˆr )

r2 ≡ r2 rˆ2 = r2 (+ eˆr )

€ €

Thus,

r = r eˆr

r1 = −r1 eˆr

r2 = r2 eˆr

€

(Eq 1)

Using Figure 2 and Eq 1, we can see:
€


 
r = −r1 + r2
= − (−r1 eˆr ) + ( r2 eˆr )
= r1 eˆr + r2 eˆr
= ( r1 + r2 ) eˆr


Therefore, the magnitude (or length) of r is r = r1 + r2 and:

€
€

€
6 THE RADIAL VELOCITY EQUATION
€

  
r = r2 − r1

(Eq 2)

THE CENTER OF MASS FRAME OF REFERENCE
The general two‐body equation for the center of mass is:
 m1r1 + m2 r2
R=
m1 + m2

where m1 ≡ mass of the first body (which, in this derivation, is the star)

€

m2 ≡ mass of the second body
€ (which, in this derivation, is the planet)

R ≡ vector pointing from specified origin to CM

r1 ≡ vector pointing from specified origin to first body

r2 ≡ vector pointing from specified origin to second body

€In the center of mass reference frame, the location of the CM is designated as the location of the origin
and the following substitutions then follow:
€

R=0


r1 = vector pointing from CM to first body

r2 = vector pointing from CM to second body

€
The general equation then becomes:
€



m1r1 + m2 r2
0=
m1 + m2

€



0 = m1r1 + m2 r2

€

Therefore,



m1r1 = −m2 r2

€

(Eq 3)



Using the expressions for r1 and r2 in Eq 1 and substituting them into Eq 3, we find:
€

€

€



m1r1 = −m2 r2
m1 (−r1 eˆr ) = −m2 (r2 eˆr )
− m1r1 eˆr = −m2 r2 eˆr

Therefore,
€

m1r1 = m2 r2

€

(Eq 4)

THE RADIAL VELOCITY EQUATION 7

THE LAWS OF ISAAC NEWTON
Newton’s Law of Universal Gravitation tells us the star exerts a gravitational force on the planet and
the planet exerts a gravitational force on the star. Both forces are equal in magnitude, opposite in
direction, and act along the line connecting the star and planet (shown in Figure 3).

Note that, in Figure 3:

F12 ≡ Force on object 1 (the star) exerted by object 2 (the planet)

F21 ≡ Force on object 2 (the planet) exerted by object 1 (the star)
€
The magnitude
of any gravitational force between two objects is directly proportional to the product of
the masses of each object and inversely proportional to the distance between them squared:
€

Fg = G

m1m2
r2

The constant of proportionality is called Newton’s gravitational constant: G = 6.67 × 10−11
€


F12 and F21 thus have the same magnitude Fg and only differ in direction:

€

€

€

Therefore,


mm
F12 = G 1 2 2 (+ eˆr ) €
r

mm
F21 = G 1 2 2 (− eˆr )
r

mm
F12 = G 1 2 2 eˆr
r

mm
F21 = − G 1 2 2 eˆr
r

€

€

8 THE RADIAL VELOCITY EQUATION
€

m3
kg s2

(EQ 5)
(EQ 6)

Now, Newton’s 2nd Law tells us:




∑ F = ma
For each body, the only force exerted on it is the gravitational force, so:
 
€
for body 1 (the star) : ∑ F = F12

Thus,


F12 = m1a1

€

(Eq 7)

And,
€

 
for body 2 (the planet) : ∑ F = F21

Thus,


F21 = m2 a2

€

(Eq 8)





d 2r
Using the expressions for F12 and F21 in Eq 5 and Eq 6 and rewriting a as 2 , Eq 7 and Eq 8 become:
€
dt

€


m1m2
d 2 r1
ˆ
G 2 er = m1 € 2
r
dt €

€


Gm2
d 2 r1
eˆr = 2
r2
dt

€

and
€


m1m2
d 2 r2
ˆ
− G 2 er = m 2 2
r
dt


Gm1
d 2 r2
− 2 eˆr = 2
r
dt

€

Subtracting Eq 9 from Eq 10 gives:

(Eq 9)

(Eq 10)

€



 Gm1   Gm 2   d 2 r2   d 2 r1 
ˆ
ˆ
−
e
−
e
=
−

 
 
 

 r 2 r   r 2 r   dt 2   dt 2 
G ( m1 + m2 )
d2  
ˆ
−
er = 2 ( r2 − r1 )
r2
dt

€

THE RADIAL VELOCITY EQUATION 9

Now, let’s make the following definition:
(Eq 11)

M ≡ m1 + m2

Using Eq 11 and Eq 2, we have:
€
−


d 2 r ˙˙
Using 2 ≡ r and r ≡ r eˆr ⇒ eˆr =
dt
€

€

GM
d2 
ˆ
e
=
(r )
r
r2
dt 2


r
, we have:
r

€

€

˙r˙ = − GM eˆ
r
r2

(Eq 12)

˙r˙ = − GM r
r3

(Eq 13)

THE LAWS
OF JOHANNES KEPLER
€
As the star and planet orbit their mutual center of mass, the distance between them, r, changes.
According to Kepler’s 1st Law (and extending the treatment to extrasolar planets), planets revolve
around their host star in an elliptical orbit with the star at one focus of the ellipse (shown in Figure 4).

r
θ

Figure 4 – As the planet orbits its host star, the distance between the star and planet changes. (Not to scale!)

10 THE RADIAL VELOCITY EQUATION

It is useful to express r in polar coordinates and, thus, as a function of θ.



Recall that r = r eˆr . Now, take the derivative of r with respect to time:
d 
d
d
d
r ) = ( r eˆr ) = r ( eˆr ) + eˆr ( r)
(
dt € dt
dt
dt

€

(Eq 14)

eˆr is the direction of the vector pointing from the star to the planet and it should be understood that
this direction changes with time.
€
€

In order to calculate the derivative of eˆr with respect to time, we must first express eˆr in terms of
Cartesian coordinates (the derivation of this expression can be looked up elsewhere):

eˆr = cos θ xˆ + sin θ yˆ

€

€

Now, we can easily determine the derivative of eˆr with respect to time:

€
d
d
(eˆr ) = (cos θ xˆ + sin θ yˆ )
dt
dt
€
d
d
d
d
= cos θ ( xˆ ) + xˆ (cos θ ) + sin θ ( yˆ ) + yˆ (sin θ )
dt
dt
dt
dt
d
d
= 0 + xˆ (cos θ ) + 0 + yˆ (sin θ )
dt
dt
We were able to do the last step because xˆ and yˆ are independent of time (and, thus, taking the
derivative of€either with respect to time gives zero).
However, θ does depend on time,€so we must take this into account when taking the time derivative of
€
sin θ and cos θ:
d
d
d
(eˆr ) = xˆ (cos θ ) + yˆ (sin θ )
dt
dt
dt
= xˆ −sin θ θ˙ + yˆ cos θ θ˙

(

)

(

)

= − θ˙ sin θ xˆ + θ˙ cos θ yˆ
= θ˙ (−sin θ xˆ + cos θ yˆ )

The expression in parentheses is Equal to eˆθ expressed in terms of Cartesian coordinates (the
derivation of this expression can be looked up in the same “elsewhere”). In other words:
€

eˆθ = −sin θ xˆ + cos θ yˆ

€
And so,

€

d
( eˆr ) = θ˙ eˆθ
dt

(Eq 15)
THE RADIAL VELOCITY EQUATION 11

€

Substituting Eq 15 into Eq 14 gives:
d 
(r ) = r θ˙ eˆθ + eˆr r˙
dt

( )


dr ˙
Using
≡ r , we have:
dt
€
€


r˙ = r˙ eˆr + r θ˙ eˆθ

(Eq 16)


Now, take the derivative of r˙ with respect to time:
€

€

d ˙
d
r =
r˙ eˆr + r θ˙ eˆθ
dt
dt
d
d
d ˙
d
= r˙ (eˆr ) + eˆr ( r˙) + r
θ eˆθ + θ˙ eˆθ ( r)
dt
dt
dt
dt

d
d ˙ ˙
= r˙ θ˙ eˆθ + eˆr (˙r˙) + r θ˙ (eˆθ ) + eˆθ
θ + θ eˆθ r˙
 dt
dt 

()

(

)

( )

( )

()

d ˙
d
r = r˙ θ˙ eˆθ + r˙˙ eˆr + r θ˙ ( eˆθ ) + r θ˙˙ eˆθ + r˙ θ˙ eˆθ
dt
dt

()

€

(Eq 17)

Now, we must take the derivative of eˆθ with respect to time:

€

d
d
(eˆθ ) = (−sin θ xˆ + cos θ yˆ )
dt
dt
€
d
d
d
d
= −sin θ ( xˆ ) + xˆ (−sin θ ) + cos θ ( yˆ ) + yˆ (cos θ )
dt
dt
dt
dt
˙
˙
= 0 + xˆ −cos θ θ + 0 + yˆ −sin θ θ

(

)

(

)

= − θ˙ cos θ xˆ − θ˙ sin θ yˆ
= − θ˙ (cos θ xˆ + sin θ yˆ )
= − θ˙ (eˆr )
And so,
(Eq 18)

d
( eˆθ ) = − θ˙ eˆr
dt

€
Substituting Eq 18 into Eq 17 gives:

€
d ˙
r = r˙ θ˙ eˆθ + ˙r˙ eˆr + r θ˙ − θ˙ eˆr + r θ˙˙ eˆθ + r˙ θ˙ eˆθ
dt
= 2 r˙ θ˙ eˆθ + ˙r˙ eˆr − r θ˙ 2 eˆr + r θ˙˙ eˆθ
= ˙r˙ − r θ˙ 2 eˆ + r θ˙˙ + 2 r˙ θ˙ eˆ

()

(

(

12 THE RADIAL VELOCITY EQUATION
€

)

r

(

)

)

θ

Therefore,

r˙˙ = ( r˙˙− r θ˙2 ) eˆr + ( r θ˙˙+ 2 r˙ θ˙) eˆθ

(Eq 19)

Substituting Eq 19 into Eq 12 gives:
€

(˙r˙ − r θ˙ ) eˆ + (r θ˙˙ + 2 r˙ θ˙) eˆ
2

r

θ

=−

GM
eˆr
r2

The only way for the above equation to be true is if:
€

GM
r˙˙− r θ˙2 = − 2
r

(Eq 20)

r θ˙˙+ 2 r˙ θ˙ = 0

(Eq 21)

and,

€

To extract an important piece of information from Eq 21, recall this:

€d
d ˙ ˙d 2
r 2 θ˙ = r 2
θ + θ (r )
dt
dt
dt
2 ˙˙
˙
= r θ + θ (2r˙r)
= r 2 θ˙˙ + 2r˙rθ˙

( )

()

= r r θ˙˙ + 2˙rθ˙

(

)

So, the left‐hand side of Eq 21 is also equal to
€

1 d 2 ˙
r θ
r dt

( )

and thus,
€

1 d 2 ˙
r θ =0
r dt

(

)

from which, follows:
€

(Eq 22)

d 2 ˙
(r θ ) = 0
dt

The quantity r 2 θ˙ does not change with time, so the quantity is said to be conserved.

€
In fact, r 2 θ˙ is a well‐known quantity, as we shall now see.
€
€

THE RADIAL VELOCITY EQUATION 13

ANGULAR MOMENTUM
Recall the general equation for total angular momentum:
  
L=r×p


where : L = total angular momentum

r = displacement vector €


p = total linear momentum = mv



For a planet orbiting its host star, r and v are always perpendicular (shown in Figure 5).
€

€

€

v
r

Figure 5 – As the planet orbits its host star, its position vector


r

and velocity vector


v

are always perpendicular. (Not to scale!)


 


 
So, r × p = r × mv = m ( r × v ) = m [€rv (sin 90°)] = m €
[rv (1)] = mrv and thus, L ≡ L = mvr

Now,

€

L
is defined to be the SPECIFIC ANGULAR MOMENTUM and is denoted by the symbol h.
m
€

Using v = ω r and ω ≡
€

dθ ˙
L mvr
= θ , so that v = θ˙ r , we have h ≡ =
= vr = θ˙ r r = r 2θ˙ , therefore,
dt
m
m

( )

h = r 2 θ˙

(Eq 23)
€
€
€
€
And so, Eq 21 tells us that the specific angular momentum for our situation is a conserved quantity.

€
14 THE RADIAL VELOCITY EQUATION

THE EQUATION OF AN ELLIPSE
Now we are ready to utilize Eq 20 for the purpose of finding r as a function of θ.
First, a brief trick. Let’s express r θ˙ 2 in terms of h:
h = r 2 θ˙ ⇒ h 2 = r 4 θ˙ 2 = r 3 r θ˙ 2

(

€

)

h2
⇒ r θ˙ 2 = 3
r

Substituting this result into Eq 20 gives:
€
˙r˙ −

h2
GM
=− 2
3
r
r

Or, solving for ˙r˙:
€

r˙˙ =

€

(Eq 24)

h 2 GM
− 2
r3
r

Next, we must remove the time dependence of r. To do this, we invoke a substitution:
€

u≡

1
1
⇒ r = = u−1
r
u

Taking the derivative of r with respect to time gives:
€

Using

d
d
du
(r) = (u−1) = −u−2
dt
dt
dt

du du dθ du ˙
=
=
θ , the above equation becomes:
dt dθ dt dθ
€
d
du
du
du
du
= − ( h)
(r) = − (u−2 ) θ˙ = − ( r 2 ) θ˙ = − r 2 θ˙
dt
dθ
dθ
dθ
dθ

( )

€

Therefore,
€

r˙ = − h

(Eq 25)

du
dθ

Taking the derivative of r˙ with respect to time (and remembering that h is independent of time) gives:

€

d
d
du 
d  du 
(r˙) = − h  = − h  
dt
dt 
dθ 
dt  dθ 

€

€

THE RADIAL VELOCITY EQUATION 15

d  du  d dθ du d 2 u dθ d 2 u ˙
Using   =
=
=
θ , we find:
dt  dθ  dθ dt dθ dθ 2 dt dθ 2
d
d 2u
(r˙) = − h 2 θ˙
dt
dθ

€

Therefore,
€

(Eq 26)

d 2u
r˙˙ = − h θ˙
dθ 2

Substituting Eq 26 into Eq 24 gives:
€

Replacing r with

d 2 u h 2 GM
− h θ˙
=
− 2
dθ 2 r 3
r

1
d 2u
, using Eq 23, and solving for
gives:
2
u
d
θ
€

d 2u
1
= − ˙ ( h 2 u 3 − GMu 2 )
2
dθ€
hθ

€

=−

(h ) u 3 + GMu 2
θ˙
(h ) θ˙

(r θ˙) u
=−
2

3

θ˙

+

GMu 2
r 2 θ˙ θ˙

( )
GM
= − (r ) u +
(u )
r θ˙
2

3

2

2

2

1
GM  1 
= −  2  u3 + 2 ˙ 2  2 
u 
r θ r 
GM
=− u+ 4 2
r θ˙

(

=− u+

)

GM
(h 2 )

Therefore,
€

d 2u
GM
= −u + 2
2
dθ
h

Eq 27 is a differential equation with the following solution:
€

16 THE RADIAL VELOCITY EQUATION

(Eq 27)

u (θ ) = A cos (θ − δ ) +

where :

GM
h2

(Eq 28)

A ≡ constant 
 both will be determined by initial conditions
δ ≡ phase shift  €

Changing variables back to r, Eq 28 becomes:

€

1
GM
= A cos (θ − δ ) + 2
r (θ )
h

So,
€

r (θ ) =

(Eq 29)

1
GM
A cos (θ − δ ) + 2
h

h2
Multiplying the right‐hand side of Eq 29 by 2 gives:
h
€

€

r (θ ) =

h2
h 2 A cos (θ − δ ) + GM

Dividing the right‐hand side of the above equation by GM gives:

€

h2
GM
r (θ ) = 2
h A cos (θ − δ )
+1
GM

(Eq 30)

The general equation for an ellipse is:
€

r (θ ) =

where :

€

a (1− e 2 )

(Eq 31)

1+ e cos θ

a ≡ semi - major axis of the ellipse
€
e ≡ eccentricity of the ellipse

Comparing Eq 30 to Eq 31, we can immediately see:
e=

€

h 2A
GM

(Eq 32)

THE RADIAL VELOCITY EQUATION 17

Or,

h2
e
h2
e
= and thus, a (1− e 2 ) =
= . So that,
GM A
GM A

a=
€

€

(Eq 33)

e
A (1− e 2 )

Therefore, the unknown constant A in Eq 28 in terms of known variables is:

€

A=

(Eq 34)

GMe
h2

and, δ = 0 (a proof of this is provided in Appendix A).

€

€

PROPERTIES OF AN ELLIPSE
In a sense, we have thus far analyzed the star‐planet system in one dimension (when we computed the
gravitational forces) and in two dimensions (when we determined an expression for r as a function of
θ) and our next task is to develop the tools needed to fully understand this system in three dimensions.
First, let’s review some important properties of an ellipse:
The major axis of an ellipse is the straight line that runs between the foci of the ellipse and extends to
the edges of the ellipse (shown in Figure 6). One‐half of the major axis (aptly named the “SEMI‐MAJOR
AXIS”) has a length defined to be equal to a, therefore, the length of the major axis is equal to 2a.

length = 2a
Focus

Focus

Figure 6 – The major axis of an ellipse.

18 THE RADIAL VELOCITY EQUATION

The minor axis of an ellipse is the straight line that lies perpendicular to the major axis and passes
through the midpoint of the major axis (shown in Figure 7). One‐half of the minor axis (aptly named
the “SEMI‐MINOR AXIS”) has a length defined to be equal to b, therefore, the length of the minor axis
is equal to 2b.

length = 2b
Focus

Focus

Figure 7 – The minor axis of an ellipse.

PERIASTRON is defined to be the position in a planet’s orbit around its host star in which the distance
between the star and planet is a minimum for the orbit. Similarly, APASTRON is defined as the position
in a planet’s orbit around its host star in which the distance between the star and planet is a maximum
for the orbit (shown in Figure 8).

apastron

periastron

Figure 8 – The positions of periastron and apastron in a planet’s orbit around its host star. (Not to scale!)

THE RADIAL VELOCITY EQUATION 19

The ECCENTRICITY of an ellipse, or how elongated the ellipse is, is denoted by the symbol e and is
defined in terms of the semi‐major and semi‐minor axes:
e 2 ≡ 1−

b2
a2

(Eq 35)

In the special case in which a = b, e = 1−1 = 0 and the shape of a planet’s orbit around its host star
would be a perfect circle.
€
Finally, the area of an ellipse is defined to be:
€

Area = π ab

(Eq 36)

Notice that for a circle a = b and the area is equal to πa2 or πb2 as one would expect!

€
€

DEFINITIONS OF ORBITAL PARAMETERS

Now, let’s define two terms (shown in Figure 9):
LINE‐OF‐SIGHT ≡ the straight line connecting an observer and the object being orbited (in our case,
we will take this to be the star)
PLANE‐OF‐SKY ≡ the two dimensional plane that lies perpendicular to the line‐of‐sight and passes
through the object being orbited

line‐of‐sight

plane‐of‐sky (seen “edge‐on”)

plane‐of‐sky
(seen “face‐on”)
Figure 9 – An observer’s line‐of‐sight and the plane‐of‐sky seen both “edge‐on” and “face‐on.” (Not to scale!)

20 THE RADIAL VELOCITY EQUATION

We are now ready to analyze the star‐planet system in three dimensions (shown in Figure 10):

Figure 10 – Illustration of orbital parameters for the star‐planet system.

There are two separate planes in Figure 10: the plane‐of‐sky (already defined) and the PLANE‐OF‐
ORBIT (the two dimensional plane in which the planet orbits its host star). The plane‐of‐orbit is tilted
with respect to the plane‐of‐sky by a certain angle. We call this tilt the ORBITAL INCLINATION and
denote the angle by the symbol i.
There are two points in the planet’s orbit that pass through the plane‐of‐sky. One is called the
ASCENDING NODE (the point at which the planet passes from “below” the plane‐of‐sky to “above” the
plane‐of‐sky) and the other is called the DESCENDING NODE (the point at which the planet passes from
“above” the plane‐of‐sky to “below” it).
The line connecting these two points is called the LINE OF NODES.
The angle θ is the angle between the periastron and the position of the planet. It’s referred to as the
TRUE ANOMALY and it changes with time. This is the same θ that is found in Figure 4, Eq 28, & Eq 31.
The angle ω is the angle between the line of nodes and periastron. It’s referred to as the ARGUMENT
OF PERIASTRON and it does not change with time.
Both θ and ω lie in the plane‐of‐orbit.
THE RADIAL VELOCITY EQUATION 21

RADIAL VELOCITY
If we designate the plane‐of‐sky to be the x-y plane, then the direction to the observer along the line‐
of‐sight is the z‐direction.
In terms of θ, ω, and i, z can be expressed as:
z = r sin (θ + ω ) sin i

(Appendix B explains how this is determined.) Remember that this entire derivation is devoted to
finding an expression for the radial velocity (denoted by vr) and that the radial velocity is defined to be
€
the velocity along the observer’s line of sight. Thus, since z is the direction along the observer’s line of
sight, the derivative of z with respect to time shall provide us with the expression for radial velocity!
Recalling that θ and r change with time, however, ω and i do not, we find:

d
d
(z) = (r sin (θ + ω ) sin i)
dt
dt
d
d
= r (sin (θ + ω ) sin i) + sin (θ + ω ) sin i ( r)
dt
dt


d
d
= r sin (θ + ω ) (sin i) + sin i {sin (θ + ω )} + sin (θ + ω ) sin i r˙


dt
dt


di
d
= r sin (θ + ω ) cos i + sin i cos (θ + ω ) (θ + ω ) + r˙ sin (θ + ω ) sin i


dt
dt
= r 0 + sin i cos (θ + ω ) θ˙ + r˙ sin (θ + ω ) sin i

v r ≡ z˙ =

[

]

Therefore,

€

vr = [r θ˙ cos (θ + ω ) + r˙ sin (θ + ω ) ] sin i

Now, we must find expressions for r˙ and θ˙ in order to rid Eq 37 of these two quantities.
€
To find r˙ , we take the derivative of Eq 31 with respect to time (a and e are time‐independent):

€

€

€

2
d
d  a (1− e ) 

r˙ ≡ ( r) = 
dt
dt 1+ e cos θ 

=

[1+ e cos θ ]

22 THE RADIAL VELOCITY EQUATION
€

d
d
a (1− e 2 ) − a (1− e 2 )
[1+ e cos θ ]
dt
dt
2
[1+ e cos θ ]

[

] [

]

(Eq 37)

=

0 − a (1− e 2 ) − e θ˙ sin θ

[

][

[1+ e cos θ ]

]

2

a (1− e 2 )  e θ˙ sin θ 
=


1+ e cos θ 1+ e cos θ 
Thus,

€

r˙ =

(Eq 38)

r e θ˙ sin θ
1+ e cos θ

To find θ˙ , we make use of Kepler’s 2nd Law:
(Eq 39)

dA 1 2 ˙
= rθ
dt 2

€

€

where A is the area of the ellipse. Integrating the left‐hand side of Eq 39 over one period (the time it
takes the planet to make one complete revolution around its host star) yields:
€
(Eq 40)

A 1 2˙
= rθ
P 2

where P is the period. We know the area of an ellipse is A = πab (from Eq 36), but to get the area in
terms of a and e only, we need to solve Eq 35 in terms of b:
€
e 2 ≡ 1−

b2
a2

⇒

2
b€
= 1− e 2
a2

b 2 = a 2 (1− e 2 )

⇒

And so, b = a 1− e 2 and putting this into the equation for the area of an ellipse gives:
€
A = πab = πa a 1− e 2
€

(

)

Therefore,
A = πa 2 1− e 2

€

(Eq 41)

Substituting Eq 41 into Eq 40 gives:
€

πa 2 1− e 2 1 2 ˙
= rθ
P
2

Instead of solving the above equation for θ˙ , we will solve it for rθ˙ since this quantity is found in Eq 37,
which we are trying to simplify:
€
€

2
2πa €
1− e 2
˙
rθ =
rP

(Eq 42)

THE RADIAL VELOCITY EQUATION 23

€

Now, we have found expressions for r˙ (Eq 38) and rθ˙ (Eq 42), but the expression for r˙ has an rθ˙ in it
and the expression for rθ˙ has an r in it. So, let’s rid these expressions of any r or θ˙ dependence:
2
2
€2πa 1− e
r θ˙ =
rP
1 2πa 2 1− e 2 

= 
r 
P

1+ e cos θ   2πa 2 1− e 2 


=
2
P

 a (1− e )  

€
€

€

€

€

Thus,

2πa (1+ e cos θ )
r θ˙ =
P 1− e 2

€

(Eq 43)

And,

r e θ˙ sin θ
1+ e cos θ
 e sin θ 
= r θ˙ 

1+ e cos θ 

€ r˙ =

2πa (1+ e cos θ )   e sin θ 
=


 P 1− e 2
 1+ e cos θ 
Thus,

r˙ =

€

2πa e sin θ
P 1− e

(Eq 44)

2

Substituting Eq 43 and Eq 44 into Eq 37 gives:

€
Vr = r θ˙ cos (θ + ω ) + r˙ sin (θ + ω ) sin i

[

]

2πa (1+ e cos θ ) cos (θ + ω ) 2πa e sin θ sin (θ + ω ) 
=
+
 sin i


P 1− e 2
P 1− e 2

Vr =
€

2πa sin i
P 1− e

2

[ cos (θ +ω ) + e cos θ

cos (θ + ω ) + e sin θ sin (θ + ω )]

Next, we need to simplify Eq 45 by utilizing the following two trigonometric identities:

€

cos (θ + ω ) = cos θ cos ω − sin θ sin ω
sin (θ + ω ) = sin θ cos ω + cos θ sin ω

€ EQUATION
24 THE RADIAL VELOCITY

(Eq 45)

The expression within the brackets in Eq 45 becomes:

[ ] = cos θ cos ω − sin θ sin ω + e cos θ (cos θ cos ω − sin θ sin ω ) + e sin θ (sin θ cos ω + cos θ sin ω )
= cos θ cos ω − sin θ sin ω + e cos ω cos2 θ − e cos θ sin θ sin ω + e cos ω sin 2 θ + e cos θ sin θ sin ω
= cos θ cos ω − sin θ sin ω + e cos ω (cos 2 θ + sin 2 θ )
= cos θ cos ω − sin θ sin ω + e cos ω

€

We used the trigonometric identity cos2 θ + sin 2 θ = 1 in the last step and we can now revert
cos θ cos ω − sin θ sin ω back to cos (θ + ω ) for a more compact expression:
€

€

€

Vr =

2πa sin i
P 1− e 2

(Eq 46)

[cos (θ + ω ) + e cos ω ]

Finally, we have derived the equation for radial velocity!
€
Thus, the radial velocity of the host star (with respect to the center of mass) is:
Vr (star ) =

2πa1 sin i
P 1− e

2

(Eq 47)

[ cos (θ +ω ) + e cos ω ]

and the radial velocity of the orbiting planet (with respect to the center of mass) is:
€
Vr (planet ) =

2πa2 sin i
P 1− e

2

(Eq 48)

[ cos (θ +ω ) + e cos ω ]

€
RADIAL
VELOCITY SEMI-AMPLITUDE

We have one more quantity to provide a name and symbol for:

K ≡ radial velocity semi ‐ amplitude =

(Eq 49)

2πa sin i
P 1− e

2

The radial velocity semi‐amplitude of the host star is:

€

K1 ≡ radial velocity semi ‐ amplitude of host star =

(Eq 50)

2πa1 sin i
P 1− e 2

and the radial velocity semi‐amplitude of the orbiting planet is:
€

K 2 ≡ radial velocity semi ‐ amplitude of orbiting planet =

2πa2 sin i
P 1− e

(Eq 51)

2

THE RADIAL VELOCITY EQUATION 25
€

The radial velocity method of detecting extrasolar planets involves taking precise measurements of a
star’s radial velocity with an optical telescope. Each measurement is associated with a specific time and
a plot can be created showing the star’s radial velocity as a function of time.
If a previously undiscovered planet exists in orbit around the observed star, the data in the plot will
show a repeated trend and a curve can be fit to the data connecting each of the individual radial
velocity data points (shown in Figure 11).

Figure 11 – Plot of radial velocity vs. time for the host star indicating how the period, P, and radial velocity semi‐amplitude, K, can be
determined from the data. (Image Credit: Planetary Systems and the Origins of Life, Cambridge University Press, 2007)

The radial velocity semi‐amplitude of the host star can then be determined from the plot. It is equal to
half of the total amplitude of the fitted curve (as seen in Figure 11). Note that the period, which is the
total amount of time elapsed between two consecutive peaks of the fitted curve (and is the same for
both the host star and orbiting planet), can be determined from the plot as well (as seen in Figure 11).
If preferred, the dependence on a1 in the quantity K1 can be removed. This will be our next task.
Kepler’s 3rd Law relates the semi‐major axis of a planet’s orbit to the period of its orbit as follows:
P2 =

4π 2
3
a2
G ( m1 + m2 )

Solving Eq 52 for a2 gives:
€

26 THE RADIAL VELOCITY EQUATION
€

G ( m1 + m2 ) P 2
a2 =
4π 2
3

(Eq 52)

Therefore,
(Eq 53)

1

G ( m1 + m2 ) P 2  3
a2 = 

4π 2



Now we need to refer all the way back to page 7 and Eq 4. With our “new” knowledge of ellipses, we
can now recognize that the r1 in
€ Eq 4, which is the magnitude of the vector pointing from the CM to the
star, is simply the semi‐major axis of the star’s orbit around the mutual CM, a1. With the same
reasoning, the r2 in Eq 4, which is the magnitude of the vector pointing from the CM to the planet, is
the semi‐major axis of the planet’s orbit around the mutual CM, a2. Therefore,

m1a1 = m2 a2
or, solving for a1:

€

m2
a2
m1

(Eq 54)

2π sin i  m2 
 a2 
P 1− e 2  m1 

(Eq 55)

a1 =

Substituting Eq 54 into Eq 50 gives:

€

K1 =

Substituting Eq 53 into Eq 55 gives:
€


2π sin i  m2
K1 =

P 1− e 2  m1


1
 G ( m1 + m2 ) P 2  3 

 
4π 2

 


(Eq 56)

The process of simplifying Eq 56 goes something like this:
€

1

K1 =

m2
m1

3
2
sin i 8π G ( m1 + m2 ) P  3


4π 2 P 3

1− e 2 

1

m
= 2
m1

sin i 2πG ( m1 + m2 )  3


P

1− e 2 
1

1
 2πG  3 m2
=

(m1 + m2 ) 3
 P  m1

€

sin i
1− e 2

THE RADIAL VELOCITY EQUATION 27

This is the point at which we utilize the fact that m1 >> m2 and so our answer is not significantly
affected if we use the following approximation:

€

m1 + m2 ≈ m1

Now we can continue our simplification:

€

1

1
 2πG  3 m2
K1 = 

(m1 ) 3
 P  m1

1

sin i
1− e 2

1

 2πG  3 ( m1 ) 3 m2 sin i
=

 P  m1
1− e 2
1
2
 2πG  3
m2 sin i
−
=
 ( m1 ) 3
 P 
1− e 2

Therefore, in its most common form, the equation for the radial velocity semi‐amplitude of the star is:

€

1

 2πG  3 m2 sin i
K1 = 

 P  m12 / 3

€

28 THE RADIAL VELOCITY EQUATION

1
1− e 2

(Eq 57)

APPENDIX A: PROOF THAT δ = 0
To provide proof that δ = 0 in Eq 28, we will analyze the special case in which the planet is located at
PERIASTRON (the position in a planet’s orbit around its host star in which the distance between the
star and planet is a minimum for the orbit).

€
The position of periastron is useful for two reasons: (1) we know the value of θ is equal to zero for this
position in a planet’s orbit around its host star and (2) we know the expression for r(θ), the distance
between the planet and its host star. The first reason can be understood by re‐examining Figure 10 or
re‐reading the definition of the TRUE ANOMALY. The second reason follows from the fact that, for any
ellipse, the distance between the center of the ellipse and either focus of the ellipse (one of which is
also the position of the host star) is equal to ae (shown in Figure 12).
For example, in the special case of a circular orbit e = 0 and the “ellipse” (or circle, which is a special
type of ellipse) has only one focus (the location of which is the position of the host star). This single
focus is located at the center of the ellipse, therefore, the distance between the focus and the center
of the ellipse is zero which agrees with ae = a(0) = 0 (shown in Figure 13).

ae
Focus

ae
Focus

center of ellipse
Figure 12 – The distance between the center of an ellipse
and either of its foci is equal to the product of the length
of the semi‐major axis and the eccentricity of the ellipse.

Figure 13 – The blue dot represents both the center of the
circle (a special type of ellipse) and the single focus of the
ellipse. In this special case, the product ae is equal to zero.

The expression for r(θ), the distance between the planet and its host star, is equal to the distance
between the planet and the center of the ellipse (which, in this case, is the length of the semi‐major
axis, a) minus the distance between the star and the center of the ellipse, ae (shown in Figure 14).
Thus, the expression for r(θ), the distance between the planet and its host star, equals:
r (θ ) = a − ae

or, after simplifying:
€

r (θ ) = a (1− e)

(Eq A.1)
THE RADIAL VELOCITY EQUATION 29

€

a

apastron
ae

r(θ)

periastron

center of ellipse

Figure 14 – The distance between the planet and its host star (r(θ), represented by the black arrow) is equal to the
distance between the planet and the center of the ellipse (a, represented by the purple arrow, which is also the semi‐
major axis; note that this arrow is not drawn at the exact location of the semi‐major axis otherwise it would overlap with
the other arrows) minus the distance between the star and the center of the ellipse (ae, represented by the red arrow).

The task at hand is to solve Eq 29 for δ. We can substitute Eq A.1 for the left‐hand side of Eq 29 and use
GM A
θ = 0. We can also rearrange Eq 34 as 2 = . The result of these substitutions is:
h
e

r (θ ) =
€

1
A cos (θ − δ ) +

a (1− e) =

GM
h2

1
A cos (0 − δ ) +

A cos (−δ ) +

A
1
=
e a (1− e)

A cos (−δ ) =

1
A
−
a (1− e) e

cos (−δ ) =

1
1
−
Aa (1− e) e

€

30 THE RADIAL VELOCITY EQUATION
€

A
e

(Eq A.2)

Now rearranging Eq 33 as A =

e
and substituting this into Eq A.2, we find:
a (1− e 2 )
cos (−δ ) =

€
=

=

1
1
−
Aa (1− e) e
1
1
−
e
a 1− e)] e
2 [ (
a (1− e )
1
1
−
e (1− e) e
(1− e 2 )

1− e 2
1
=
−
e (1− e) e
1 1− e 2 
= 
−1
e  1− e

1 1− e 2 1− e 
= 
−

e  1− e 1− e 
1 1− e 2 − (1− e) 
= 

e
1− e

1 1− e 2 −1+ e 
= 

e  1− e

1  e − e2 
= 

e  1− e 
1  e (1− e) 
= 

e  1− e 

=

1
(e)
e

THE RADIAL VELOCITY EQUATION 31
€

Thus,
cos (− δ ) = 1

The cosine is an even function, so we can exploit the following property of even functions:
€
for any angle a: cos ( a) = cos (−a)

And so,
€
cos (− δ ) = cos (δ ) = 1

Thus,
€

cos (δ ) = 1 ⇒ δ = cos−1 (1) = 0

Therefore, δ = 0 .

€
€

32 THE RADIAL VELOCITY EQUATION

APPENDIX B: THE EXPRESSION FOR z
It might be a bit difficult to understand where the equation for z comes from, so I’ve included a more
detailed illustration of the angles and lengths in question (shown in Figure 15).

Figure 15 – A diagram specifically created to show the important
lengths and angles needed for determining an expression for z.

Part of the planet’s orbit around its host star has been made bold in the diagram. We will assume this
to be a straight length and refer to it as (bold length) in the following equations. Note that the actual
value for the length is not needed.

ω is the angle between the line‐of‐nodes (y‐axis in Figure 15) and periastron. θ is the angle between

periastron and the planet’s position vector, r (the magnitude of which is r, the distance between the
planet and its host star). The angle between the y‐axis and the planet’s position vector is θ + ω (I’ll
leave it to the reader to make certain he/she understands why this is the case; but if you aren’t certain,
my hint is to try making up numbers
€ for θ and ω or moving the planet to another position in its orbit).
€
We now have the necessary information and, with the aid of trigonometry, we find:

sin (θ + ω ) =
sin i =

(bold length)
r

⇒

(bold length) = r sin (θ + ω )

z
⇒ z = (bold length ) sin i ∴ z = r sin (θ + ω ) sin i
(bold length)

€
THE RADIAL VELOCITY EQUATION 33
€

REFERENCE FOR CALCULATING RV SEMI-AMPLITUDE
If you know the numerical value for each of the following parameters for a planet and its host star,
 P (the planet or host star’s orbital period in days or years)
 M planet sin i (the planet’s minimum mass in terms of the mass of Earth or Jupiter)
 M star (the mass of the host star in terms of the mass of the Sun)
€

 e (the eccentricity of the planet’s orbit around its host star – ranges from 0‐1)

then €
entering the appropriate value into one of the following four equations will give you the
numerical value of the star’s radial velocity semi‐amplitude:
1

K star

2/3
1 day  3  M planet sin i   M Sun 
1
= 0.6395 m s 
 
 

 P   M Earth   M star 
1− e 2

K star

1 yr  3  M planet sin i   M Sun 
= 0.0895 m s−1 
 
 

 P   M Earth   M star 

K star

1 day  3
= 203.255 m s 

 P 

K star

1 yr  3
= 28.435 m s−1 

 P 

−1

1

1
−1

1

€

34 THE RADIAL VELOCITY EQUATION

2/3

1
1− e 2

M
  M 2 / 3 1
planet sin i

  Sun 
1− e 2
 M Jupiter   M star 

M
  M 2 / 3 1
planet sin i

  Sun 
M
1− e 2

Jupiter
  M star 

